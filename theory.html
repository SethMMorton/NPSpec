<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>NPSpec: NPSpec Theory</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NPSpec
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
   <div id="projectbrief">Solve for the spectral properties of nanoparticles easily</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">NPSpec Theory </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#quasi">Quasistatic Approximation</a></li>
<li class="level1"><a href="#spec">Spectral Property Calculation</a></li>
<li class="level1"><a href="#dielectric">Dielectric Function</a></li>
<li class="level1"><a href="#color">Color Calculation</a></li>
</ul>
</div>
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>The following are modifications of Chapters 8 and 9 of the PhD thesis of Seth M. Morton<a class="el" href="citelist.html#CITEREF_Morton_2012_phdthesis">[7]</a>.</dd>
<dd>
Note that the subscripts \(\alpha\) and \(\beta\) indicate the general X, Y, or Z cartesian directions.</dd>
<dd>
\(\omega\) is the frequency.</dd></dl>
<p>NPSpec calculates the spectral properties of the nanoparticle by determining the frequncy-dependent polarizability, from which its optical properties can be calculated. The polarizabiliy is calculated using one of two formulas: Mie theory<a class="el" href="citelist.html#CITEREF_aple_25_377">[6]</a><a class="el" href="citelist.html#CITEREF_Bohren_1983_book">[2]</a> to simulate spheres, and the quasistatic approximation to simulate spheroids.<a class="el" href="citelist.html#CITEREF_Bohren_1983_book">[2]</a> Mie theory is an analytical solution to Maxwell's equations for spheres; Mie theory will not be derived here, but the reader is directed to Chapter 4 of Ref.<a class="el" href="citelist.html#CITEREF_Bohren_1983_book">[2]</a> for an in-depth presentation. The Mie theory code used is based on <code>n-mie</code> which is available for free online.<a class="el" href="citelist.html#CITEREF_nmie">[8]</a> <code>n-mie</code> is capable of calculating the optical efficiencies for an \(n\)-layered sphere, but NPSpec limits this to a 10 layered core@shell particle for practical reasons.</p>
<h1><a class="anchor" id="quasi"></a>
Quasistatic Approximation</h1>
<div class="image">
<img src="prolateoblate.png" alt="prolateoblate.png"/>
<div class="caption">
A prolate (cigar) and oblate (pancake) ellipsoid.</div></div>
<p>The quasistatic approxomation for spheroids is described in detail in Chapter 5 of Ref.<a class="el" href="citelist.html#CITEREF_Bohren_1983_book">[2]</a>, and will be summarized here. To use the quasistatic approximation, the nanoparticle volume \(V\), dielectric constant \(\epsilon(\omega)\), and geometrical factor \(g_{\alpha,d}\) must be known; if these are known, the frequency-dependent polarizability of the nanoparticle in a vacuum is </p>
<p class="formulaDsp">
\[ \alpha_{\alpha\alpha}(\omega) = V \frac{\epsilon(\omega) - 1 }{ 1 + g_{\alpha,d} (\epsilon(\omega) - 1)} \]
</p>
<p> where the diagonal polarizability component that is solved for is based on the direction of \(g_{\alpha,d}\). In NPSpec, the shape of the nanoparticle is limited to spheroids because these shapes have analytical forms for \(g_{\alpha,d}\). Spheroids are defined to have one independent axis \(a\) and two dependent axes \(b\) as shown in the figure above; if \(a\) is longer than \(b\), the spheroid is prolate (cigar-shaped), but if \(a\) is shorter than \(b\) it is oblate (pancake-shaped). If \(a=b\), it is a sphere. The subscript \(d\) in \(g_{\alpha,d}\) indicates the axis component ( \(a\) or \(b\)) of the spheroid. The volume of the nanoparticle is given by </p>
<p class="formulaDsp">
\[ V = \frac{4\pi}{3}ab^2 \ . \]
</p>
<p> In the case of a sphere, the geometry factor is<a class="el" href="citelist.html#CITEREF_Bohren_1983_book">[2]</a> </p>
<p class="formulaDsp">
\[ g_{\alpha,d}^\text{sphere} = \frac{1}{3} \ . \]
</p>
<p> For a prolate spheroid, </p>
<p class="formulaDsp">
\begin{gather} g_{\alpha,a}^\text{prolate} = \frac{1-e^2}{e^2}\left(-1 + \frac{1}{2e}\ln\frac{1 + e}{1 - e}\right) \\ g_{\alpha,b}^\text{prolate} = \frac{1-g_{\alpha,a}^\text{prolate}}{2} \end{gather}
</p>
<p> where </p>
<p class="formulaDsp">
\[ e = 1 - \frac{b^2}{a^2} \ . \]
</p>
<p> For an oblate spheroid, </p>
<p class="formulaDsp">
\begin{gather} g_{\alpha,b}^\text{oblate} = \frac{h(e)}{2e^2}\left[\frac{\pi}{2} - \tan^{-1}h(e)\right] - \frac{h^2(e)}{2} \\ g_{\alpha,a}^\text{oblate} = 1 - 2g_{\alpha,b}^\text{oblate} \end{gather}
</p>
<p> where </p>
<p class="formulaDsp">
\begin{gather*} h(e) = \sqrt{\frac{1 - e^2}{e^2}} \\ e^2 = 1 - \frac{a^2}{b^2} \ . \end{gather*}
</p>
<p>The above formula for the polarizability can be extended to calculate a nanoparticle in a dielectric medium as </p>
<p class="formulaDsp">
\[ \alpha_{\alpha\alpha}(\omega) = V \frac{\epsilon(\omega) - \epsilon_m } { \epsilon_m + g_{\alpha,d} (\epsilon(\omega) - \epsilon_m)} \label{seecoseq:quasi} \]
</p>
<p> where \(\epsilon_m\) is the dielectric of the medium (the solvent). Additionally, because NPSpec allows for the calculation of a core@shell nanoparticle, an extended form of the above equation that allows for a two layered particle is necessary and is given by </p>
<p class="formulaDsp">
\[ \alpha_{\alpha\alpha}(\omega) = V \frac{(\epsilon_\text{shell}(\omega) - \epsilon_m) (\epsilon_\text{shell}(\omega) + ab) + af\epsilon_\text{shell} } {(\epsilon_\text{shell}(\omega) + ab) (\epsilon_m + g_{\alpha,d}^\text{shell}(\epsilon_\text{shell}(\omega) - \epsilon_m)) + afg_{\alpha,d}^\text{shell}\epsilon_\text{shell} } \]
</p>
<p> where \(a = \epsilon_\text{core}(\omega) - \epsilon_\text{shell}(\omega)\), \(b = g_{\alpha,d}^\text{core} - fg_{\alpha,d}^\text{shell}\), and \(f\) is the fraction of the total nanoparticle volume of the core.</p>
<h1><a class="anchor" id="spec"></a>
Spectral Property Calculation</h1>
<p>The formula for the absorption, scattering, and extinction efficiencies within the quasistatic approximation are given by </p>
<p class="formulaDsp">
\begin{gather} q^\text{abs}(\omega) = \frac{x}{\pi R^3}\Im\{\bar{\mathbf{\alpha}}\} \\ q^\text{scat}(\omega) = \frac{x^4}{6\pi^2 R^6}\left|\bar{\mathbf{\alpha}}\right|^2 \\ q^\text{ext}(\omega) = q^\text{abs}(\omega) + q^\text{scat}(\omega) \end{gather}
</p>
<p> where \(x = 2\pi n_mR/\lambda\) is the <em>size parameter</em>, \(n_m\) is the refractive index of the medium, \(\lambda\) is the wavelength of the incident light, \(R\) is the nanoparticle radius, and \(\Im\{\bar{\mathbf{\alpha}}\}\) is the imaginary component of the isotropic polarizability. For spheroids, we use the radius of a sphere with the same volume as the spheroid for \(R\). Because spheroids are calculated within the quasistatic approximation, it is necessary to limit the size of the spheroid. By comparing the absorption and scattering efficiencies calculated with Mie theory against those calculated with the quasistatic approximation for a sphere, we find that an upper limit for the size parameter of 3 is acceptable; this corresponds to an effective \(R\) of about 15 nm.</p>
<h1><a class="anchor" id="dielectric"></a>
Dielectric Function</h1>
<p>All dielectric constants are taken from the handbook of Palik.<a class="el" href="citelist.html#CITEREF_Palik_1997_book">[9]</a> They have been pre-splined and hard-coded into the NPSpec library for wavelengths from 200-999 nm (inclusive) in increments of 1 nm. A select few materials also have size-correction parameters implemented, which may be useful for nanoparticles with a radius &lt; 3 nm. Briefly, the free electrons in smaller nanoparticles have a longer mean free path than the size of the nanoparticle so the electrons scatter off the surface; this causes the spectrum to broaden. To perform a size correction requires knowing the drude function for the free electrons of the nanoparticle material and the fermi velocity of the electrons in the nanoparticle material. The drude function is given by<a class="el" href="citelist.html#CITEREF_Bohren_1983_book">[2]</a> </p>
<p class="formulaDsp">
\[ \epsilon(\omega)_\text{drude} = \epsilon_{\infty} - \frac{\omega_p^2}{\omega^2+i\gamma\omega} \]
</p>
<p> where \(\epsilon_{\infty}\) is the dielectric at infinite frequency, \(\omega_p\) is the free electron plasma frequency, \(\gamma\) is the free electron excited state decay rate. The size correction parameter is given by </p>
<p class="formulaDsp">
\[ s = \frac{v\hbar}{R} \]
</p>
<p> where \(v\) is the fermi velocity and \(R\) is the nanoparticle radius. To perform the size correction, the uncorrected drude function is subtracted from the experimental dielectric function, and then the size-corrected drude function is then added back in: </p>
<p class="formulaDsp">
\[ \epsilon(\omega)_\text{corrected} = \epsilon(\omega) + \frac{\omega_p^2}{\omega^2+i\gamma\omega} - \frac{\omega_p^2}{\omega^2+i(\gamma+s)\omega} \]
</p>
<p> The drude functions and fermi velocities were taken from several sources. <a class="el" href="citelist.html#CITEREF_ao_37_5271">[10]</a><a class="el" href="citelist.html#CITEREF_ss_402_475">[1]</a><a class="el" href="citelist.html#CITEREF_prb_23_462">[5]</a><a class="el" href="citelist.html#CITEREF_drudes">[4]</a></p>
<h1><a class="anchor" id="color"></a>
Color Calculation</h1>
<p>The colors are predicted from the absorption or scattering efficiency spectrum by converting the spectrum into RBG colors values using the International Commission on Illumination (CIE) 1931 color system and D65 daylight illuminant.<a class="el" href="citelist.html#CITEREF_jce_84_1873">[11]</a><a class="el" href="citelist.html#CITEREF_cie_tables">[3]</a> For absorbance, the spectrum is converted first to transmission using </p>
<p class="formulaDsp">
\[ \text{TRAN} = 10^{-q^\text{abs}} \]
</p>
<p> and for scattering the spectrum is simply normalized. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 5 2013 00:57:16 for NPSpec by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
