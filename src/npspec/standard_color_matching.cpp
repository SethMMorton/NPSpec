/******************************************************************************
 * These color matching data sets are from the International Commision on
 * Illumination's site, www.cie.co.at.  These all correspond to the
 * wavelengths defined in wavelengths.h.  X, Y, and Z are the CIE 1931 standard
 * colorimetric observers.  D65 is the standard daylight illuminant.
 * ICCMat is the matrix used convert from spectrum to RGB values.
 *****************************************************************************/

#include "npspec/constants.h"
#include "npspec/private/standard_color_matching.h"
using namespace NPSpec;

const double CIE_Mat[3][3] = {
                               {  3.240479, -1.537150, -0.498535 },
                               { -0.969256,  1.875992,  0.041556 },
                               {  0.055648, -0.204043,  1.057311 }
                             };

const double CIE_X[NLAMBDA] = {
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     2.05802e-04,   4.83211e-04,   7.94720e-04,   1.10282e-03,
     1.37000e-03,   1.57044e-03,   1.72506e-03,   1.86645e-03,
     2.02723e-03,   2.24000e-03,   2.52948e-03,   2.88888e-03,
     3.30354e-03,   3.75880e-03,   4.24000e-03,   4.74149e-03,
     5.29375e-03,   5.93625e-03,   6.70851e-03,   7.65000e-03,
     8.78448e-03,   1.00727e-02,   1.14597e-02,   1.28904e-02,
     1.43100e-02,   1.56944e-02,   1.71435e-02,   1.87885e-02,
     2.07604e-02,   2.31900e-02,   2.61822e-02,   2.97368e-02,
     3.38273e-02,   3.84272e-02,   4.35100e-02,   4.90684e-02,
     5.51715e-02,   6.19073e-02,   6.93641e-02,   7.76300e-02,
     8.67948e-02,   9.69545e-02,   1.08207e-01,   1.20649e-01,
     1.34380e-01,   1.49408e-01,   1.65392e-01,   1.81900e-01,
     1.98503e-01,   2.14770e-01,   2.30334e-01,   2.45081e-01,
     2.58958e-01,   2.71915e-01,   2.83900e-01,   2.94870e-01,
     3.04815e-01,   3.13736e-01,   3.21631e-01,   3.28500e-01,
     3.34349e-01,   3.39211e-01,   3.43127e-01,   3.46137e-01,
     3.48280e-01,   3.49602e-01,   3.50170e-01,   3.50055e-01,
     3.49327e-01,   3.48060e-01,   3.46324e-01,   3.44195e-01,
     3.41748e-01,   3.39058e-01,   3.36200e-01,   3.33224e-01,
     3.30070e-01,   3.26655e-01,   3.22893e-01,   3.18700e-01,
     3.14011e-01,   3.08841e-01,   3.03225e-01,   2.97200e-01,
     2.90800e-01,   2.84035e-01,   2.76806e-01,   2.68990e-01,
     2.60463e-01,   2.51100e-01,   2.40841e-01,   2.29881e-01,
     2.18475e-01,   2.06882e-01,   1.95360e-01,   1.84120e-01,
     1.73190e-01,   1.62555e-01,   1.52197e-01,   1.42100e-01,
     1.32252e-01,   1.22666e-01,   1.13357e-01,   1.04343e-01,
     9.56400e-02,   8.72704e-02,   7.92729e-02,   7.16912e-02,
     6.45691e-02,   5.79500e-02,   5.18624e-02,   4.62730e-02,
     4.11335e-02,   3.63953e-02,   3.20100e-02,   2.79372e-02,
     2.41693e-02,   2.07068e-02,   1.75502e-02,   1.47000e-02,
     1.21555e-02,   9.91051e-03,   7.95785e-03,   6.29012e-03,
     4.90000e-03,   3.78450e-03,   2.95801e-03,   2.43928e-03,
     2.24703e-03,   2.40000e-03,   2.91934e-03,   3.83583e-03,
     5.18265e-03,   6.99298e-03,   9.30000e-03,   1.21341e-02,
     1.55147e-02,   1.94581e-02,   2.39811e-02,   2.91000e-02,
     3.48239e-02,   4.11316e-02,   4.79943e-02,   5.53834e-02,
     6.32700e-02,   7.16290e-02,   8.04491e-02,   8.97228e-02,
     9.94423e-02,   1.09600e-01,   1.20179e-01,   1.31123e-01,
     1.42368e-01,   1.53849e-01,   1.65500e-01,   1.77271e-01,
     1.89164e-01,   2.01198e-01,   2.13387e-01,   2.25750e-01,
     2.38300e-01,   2.51040e-01,   2.63971e-01,   2.77090e-01,
     2.90400e-01,   3.03898e-01,   3.17582e-01,   3.31446e-01,
     3.45487e-01,   3.59700e-01,   3.74083e-01,   3.88642e-01,
     4.03384e-01,   4.18318e-01,   4.33450e-01,   4.48787e-01,
     4.64323e-01,   4.80050e-01,   4.95962e-01,   5.12050e-01,
     5.28304e-01,   5.44702e-01,   5.61217e-01,   5.77825e-01,
     5.94500e-01,   6.11220e-01,   6.27976e-01,   6.44761e-01,
     6.61571e-01,   6.78400e-01,   6.95237e-01,   7.12057e-01,
     7.28827e-01,   7.45519e-01,   7.62100e-01,   7.78542e-01,
     7.94823e-01,   8.10923e-01,   8.26822e-01,   8.42500e-01,
     8.57932e-01,   8.73075e-01,   8.87882e-01,   9.02306e-01,
     9.16300e-01,   9.29819e-01,   9.42835e-01,   9.55321e-01,
     9.67251e-01,   9.78600e-01,   9.89346e-01,   9.99486e-01,
     1.00902e+00,   1.01796e+00,   1.02630e+00,   1.03402e+00,
     1.04104e+00,   1.04723e+00,   1.05249e+00,   1.05670e+00,
     1.05978e+00,   1.06179e+00,   1.06280e+00,   1.06291e+00,
     1.06220e+00,   1.06073e+00,   1.05842e+00,   1.05520e+00,
     1.05095e+00,   1.04560e+00,   1.03907e+00,   1.03142e+00,
     1.02273e+00,   1.01310e+00,   1.00260e+00,   9.91309e-01,
     9.79242e-01,   9.66400e-01,   9.52785e-01,   9.38400e-01,
     9.23242e-01,   9.07292e-01,   8.90525e-01,   8.72919e-01,
     8.54450e-01,   8.35118e-01,   8.15024e-01,   7.94290e-01,
     7.73041e-01,   7.51400e-01,   7.29498e-01,   7.07487e-01,
     6.85528e-01,   6.63779e-01,   6.42400e-01,   6.21513e-01,
     6.01087e-01,   5.81055e-01,   5.61349e-01,   5.41900e-01,
     5.22655e-01,   5.03617e-01,   4.84801e-01,   4.66223e-01,
     4.47900e-01,   4.29849e-01,   4.12090e-01,   3.94648e-01,
     3.77544e-01,   3.60800e-01,   3.44441e-01,   3.28499e-01,
     3.13006e-01,   2.97995e-01,   2.83500e-01,   2.69544e-01,
     2.56111e-01,   2.43177e-01,   2.30715e-01,   2.18700e-01,
     2.07111e-01,   1.95939e-01,   1.85183e-01,   1.74838e-01,
     1.64900e-01,   1.55367e-01,   1.46234e-01,   1.37497e-01,
     1.29154e-01,   1.21200e-01,   1.13634e-01,   1.06462e-01,
     9.96927e-02,   9.33359e-02,   8.74000e-02,   8.18879e-02,
     7.67786e-02,   7.20454e-02,   6.76615e-02,   6.36000e-02,
     5.98307e-02,   5.63100e-02,   5.29910e-02,   4.98267e-02,
     4.67700e-02,   4.37856e-02,   4.08842e-02,   3.80879e-02,
     3.54191e-02,   3.29000e-02,   3.05478e-02,   2.83596e-02,
     2.63274e-02,   2.44436e-02,   2.27000e-02,   2.10891e-02,
     1.96041e-02,   1.82386e-02,   1.69861e-02,   1.58400e-02,
     1.47930e-02,   1.38337e-02,   1.29500e-02,   1.21295e-02,
     1.13600e-02,   1.06313e-02,   9.94174e-03,   9.29145e-03,
     8.68077e-03,   8.11000e-03,   7.57881e-03,   7.08452e-03,
     6.62381e-03,   6.19341e-03,   5.79000e-03,   5.41067e-03,
     5.05403e-03,   4.71905e-03,   4.40471e-03,   4.11000e-03,
     3.83393e-03,   3.57568e-03,   3.33446e-03,   3.10950e-03,
     2.90000e-03,   2.70513e-03,   2.52382e-03,   2.35494e-03,
     2.19738e-03,   2.05000e-03,   1.91179e-03,   1.78217e-03,
     1.66065e-03,   1.54675e-03,   1.44000e-03,   1.33994e-03,
     1.24623e-03,   1.15854e-03,   1.07657e-03,   1.00000e-03,
     9.28529e-04,   8.61966e-04,   8.00137e-04,   7.42873e-04,
     6.90000e-04,   6.41304e-04,   5.96391e-04,   5.54828e-04,
     5.16176e-04,   4.80000e-04,   4.45936e-04,   4.13909e-04,
     3.83913e-04,   3.55945e-04,   3.30000e-04,   3.06071e-04,
     2.84134e-04,   2.64162e-04,   2.46126e-04,   2.30000e-04,
     2.15699e-04,   2.02915e-04,   1.91280e-04,   1.80431e-04,
     1.70000e-04,   1.59692e-04,   1.49487e-04,   1.39436e-04,
     1.29591e-04,   1.20000e-04,   1.10734e-04,   1.01938e-04,
     9.37742e-05,   8.64071e-05,   8.00000e-05,   7.46518e-05,
     7.02023e-05,   6.64270e-05,   6.31012e-05,   6.00000e-05,
     5.68988e-05,   5.35730e-05,   4.97977e-05,   4.53482e-05,
     4.00000e-05,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00
};

const double CIE_Y[NLAMBDA] = {
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   1.45862e-05,   2.38061e-05,   3.26840e-05,
     4.00000e-05,   4.49305e-05,   4.82375e-05,   5.10792e-05,
     5.46139e-05,   6.00000e-05,   6.81138e-05,   7.87039e-05,
     9.12372e-05,   1.05180e-04,   1.20000e-04,   1.35414e-04,
     1.52147e-04,   1.71172e-04,   1.93465e-04,   2.20000e-04,
     2.51349e-04,   2.86469e-04,   3.23915e-04,   3.62240e-04,
     4.00000e-04,   4.36631e-04,   4.75098e-04,   5.19249e-04,
     5.72934e-04,   6.40000e-04,   7.23489e-04,   8.23221e-04,
     9.38208e-04,   1.06746e-03,   1.21000e-03,   1.36557e-03,
     1.53690e-03,   1.72744e-03,   1.94065e-03,   2.18000e-03,
     2.44982e-03,   2.75798e-03,   3.11323e-03,   3.52432e-03,
     4.00000e-03,   4.54619e-03,   5.15750e-03,   5.82571e-03,
     6.54262e-03,   7.30000e-03,   8.09119e-03,   8.91571e-03,
     9.77464e-03,   1.06690e-02,   1.16000e-02,   1.25686e-02,
     1.35758e-02,   1.46228e-02,   1.57105e-02,   1.68400e-02,
     1.80111e-02,   1.92189e-02,   2.04571e-02,   2.17195e-02,
     2.30000e-02,   2.42950e-02,   2.56122e-02,   2.69619e-02,
     2.83544e-02,   2.98000e-02,   3.13076e-02,   3.28801e-02,
     3.45187e-02,   3.62249e-02,   3.80000e-02,   3.98457e-02,
     4.17651e-02,   4.37616e-02,   4.58388e-02,   4.80000e-02,
     5.02472e-02,   5.25764e-02,   5.49819e-02,   5.74583e-02,
     6.00000e-02,   6.26046e-02,   6.52830e-02,   6.80490e-02,
     7.09167e-02,   7.39000e-02,   7.70124e-02,   8.02656e-02,
     8.36705e-02,   8.72383e-02,   9.09800e-02,   9.49060e-02,
     9.90241e-02,   1.03341e-01,   1.07864e-01,   1.12600e-01,
     1.17550e-01,   1.22694e-01,   1.28004e-01,   1.33455e-01,
     1.39020e-01,   1.44685e-01,   1.50492e-01,   1.56494e-01,
     1.62746e-01,   1.69300e-01,   1.76208e-01,   1.83503e-01,
     1.91216e-01,   1.99379e-01,   2.08020e-01,   2.17164e-01,
     2.26806e-01,   2.36934e-01,   2.47536e-01,   2.58600e-01,
     2.70135e-01,   2.82232e-01,   2.95001e-01,   3.08553e-01,
     3.23000e-01,   3.38410e-01,   3.54686e-01,   3.71686e-01,
     3.89271e-01,   4.07300e-01,   4.25663e-01,   4.44372e-01,
     4.63470e-01,   4.82998e-01,   5.03000e-01,   5.23490e-01,
     5.44376e-01,   5.65537e-01,   5.86851e-01,   6.08200e-01,
     6.29452e-01,   6.50438e-01,   6.70977e-01,   6.90891e-01,
     7.10000e-01,   7.28172e-01,   7.45469e-01,   7.61999e-01,
     7.77873e-01,   7.93200e-01,   8.08061e-01,   8.22428e-01,
     8.36245e-01,   8.49454e-01,   8.62000e-01,   8.73843e-01,
     8.85007e-01,   8.95536e-01,   9.05469e-01,   9.14850e-01,
     9.23712e-01,   9.32061e-01,   9.39893e-01,   9.47207e-01,
     9.54000e-01,   9.60271e-01,   9.66028e-01,   9.71279e-01,
     9.76033e-01,   9.80300e-01,   9.84091e-01,   9.87428e-01,
     9.90334e-01,   9.92833e-01,   9.94950e-01,   9.96703e-01,
     9.98091e-01,   9.99107e-01,   9.99746e-01,   1.00000e+00,
     9.99861e-01,   9.99312e-01,   9.98331e-01,   9.96901e-01,
     9.95000e-01,   9.92616e-01,   9.89762e-01,   9.86461e-01,
     9.82733e-01,   9.78600e-01,   9.74078e-01,   9.69164e-01,
     9.63851e-01,   9.58132e-01,   9.52000e-01,   9.45451e-01,
     9.38499e-01,   9.31162e-01,   9.23456e-01,   9.15400e-01,
     9.07007e-01,   8.98275e-01,   8.89200e-01,   8.79777e-01,
     8.70000e-01,   8.59869e-01,   8.49407e-01,   8.38640e-01,
     8.27595e-01,   8.16300e-01,   8.04781e-01,   7.93065e-01,
     7.81178e-01,   7.69148e-01,   7.57000e-01,   7.44758e-01,
     7.32426e-01,   7.20005e-01,   7.07496e-01,   6.94900e-01,
     6.82220e-01,   6.69473e-01,   6.56674e-01,   6.43844e-01,
     6.31000e-01,   6.18157e-01,   6.05316e-01,   5.92477e-01,
     5.79639e-01,   5.66800e-01,   5.53963e-01,   5.41143e-01,
     5.28363e-01,   5.15642e-01,   5.03000e-01,   4.90454e-01,
     4.78004e-01,   4.65648e-01,   4.53381e-01,   4.41200e-01,
     4.29098e-01,   4.17054e-01,   4.05040e-01,   3.93031e-01,
     3.81000e-01,   3.68933e-01,   3.56859e-01,   3.44819e-01,
     3.32852e-01,   3.21000e-01,   3.09304e-01,   2.97809e-01,
     2.86562e-01,   2.75610e-01,   2.65000e-01,   2.54764e-01,
     2.44882e-01,   2.35317e-01,   2.26035e-01,   2.17000e-01,
     2.08183e-01,   1.99576e-01,   1.91178e-01,   1.82987e-01,
     1.75000e-01,   1.67217e-01,   1.59642e-01,   1.52278e-01,
     1.45129e-01,   1.38200e-01,   1.31495e-01,   1.25018e-01,
     1.18773e-01,   1.12766e-01,   1.07000e-01,   1.01477e-01,
     9.61881e-02,   9.11204e-02,   8.62618e-02,   8.16000e-02,
     7.71243e-02,   7.28299e-02,   6.87133e-02,   6.47711e-02,
     6.10000e-02,   5.73965e-02,   5.39567e-02,   5.06767e-02,
     4.75524e-02,   4.45800e-02,   4.17566e-02,   3.90840e-02,
     3.65650e-02,   3.42027e-02,   3.20000e-02,   2.99575e-02,
     2.80668e-02,   2.63174e-02,   2.46987e-02,   2.32000e-02,
     2.18097e-02,   2.05116e-02,   1.92887e-02,   1.81239e-02,
     1.70000e-02,   1.59041e-02,   1.48400e-02,   1.38159e-02,
     1.28399e-02,   1.19200e-02,   1.10625e-02,   1.02660e-02,
     9.52727e-03,   8.84302e-03,   8.21000e-03,   7.62512e-03,
     7.08596e-03,   6.59023e-03,   6.13566e-03,   5.72000e-03,
     5.34060e-03,   4.99336e-03,   4.67382e-03,   4.37753e-03,
     4.10000e-03,   3.83752e-03,   3.58932e-03,   3.35535e-03,
     3.13559e-03,   2.93000e-03,   2.73835e-03,   2.55968e-03,
     2.39284e-03,   2.23666e-03,   2.09000e-03,   1.95187e-03,
     1.82195e-03,   1.70010e-03,   1.58616e-03,   1.48000e-03,
     1.38138e-03,   1.28972e-03,   1.20437e-03,   1.12469e-03,
     1.05000e-03,   9.79751e-04,   9.13738e-04,   8.51849e-04,
     7.93974e-04,   7.40000e-04,   6.89779e-04,   6.43009e-04,
     5.99350e-04,   5.58460e-04,   5.20000e-04,   4.83691e-04,
     4.49505e-04,   4.17472e-04,   3.87626e-04,   3.60000e-04,
     3.34575e-04,   3.11132e-04,   2.89402e-04,   2.69114e-04,
     2.50000e-04,   2.31849e-04,   2.14687e-04,   1.98601e-04,
     1.83677e-04,   1.70000e-04,   1.57630e-04,   1.46519e-04,
     1.36594e-04,   1.27779e-04,   1.20000e-04,   1.13151e-04,
     1.06996e-04,   1.01264e-04,   9.56889e-05,   9.00000e-05,
     8.40053e-05,   7.78182e-05,   7.16284e-05,   6.56258e-05,
     6.00000e-05,   5.49076e-05,   5.03716e-05,   4.63818e-05,
     4.29280e-05,   4.00000e-05,   3.75644e-05,   3.54956e-05,
     3.36444e-05,   3.18622e-05,   3.00000e-05,   2.79547e-05,
     2.58062e-05,   2.36804e-05,   2.17031e-05,   2.00000e-05,
     2.00000e-05,   2.00000e-05,   2.00000e-05,   2.00000e-05,
     2.00000e-05,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00
};

const double CIE_Z[NLAMBDA] = {
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     9.69547e-04,   2.27624e-03,   3.74317e-03,   5.19339e-03,
     6.45000e-03,   7.39137e-03,   8.11713e-03,   8.78221e-03,
     9.54152e-03,   1.05500e-02,   1.19250e-02,   1.36332e-02,
     1.56040e-02,   1.77665e-02,   2.00500e-02,   2.24269e-02,
     2.50426e-02,   2.80859e-02,   3.17455e-02,   3.62100e-02,
     4.15933e-02,   4.77096e-02,   5.42983e-02,   6.10986e-02,
     6.78500e-02,   7.44394e-02,   8.13441e-02,   8.91892e-02,
     9.85995e-02,   1.10200e-01,   1.24491e-01,   1.41478e-01,
     1.61038e-01,   1.83052e-01,   2.07400e-01,   2.34051e-01,
     2.63342e-01,   2.95696e-01,   3.31540e-01,   3.71300e-01,
     4.15416e-01,   4.64389e-01,   5.18734e-01,   5.78966e-01,
     6.45600e-01,   7.18722e-01,   7.96694e-01,   8.77451e-01,
     9.58925e-01,   1.03905e+00,   1.11607e+00,   1.18945e+00,
     1.25898e+00,   1.32443e+00,   1.38560e+00,   1.44228e+00,
     1.49441e+00,   1.54193e+00,   1.58480e+00,   1.62296e+00,
     1.65641e+00,   1.68533e+00,   1.70994e+00,   1.73044e+00,
     1.74706e+00,   1.76004e+00,   1.76972e+00,   1.77646e+00,
     1.78064e+00,   1.78260e+00,   1.78272e+00,   1.78137e+00,
     1.77890e+00,   1.77569e+00,   1.77211e+00,   1.76838e+00,
     1.76417e+00,   1.75903e+00,   1.75249e+00,   1.74410e+00,
     1.73347e+00,   1.72060e+00,   1.70555e+00,   1.68839e+00,
     1.66920e+00,   1.64791e+00,   1.62391e+00,   1.59644e+00,
     1.56476e+00,   1.52810e+00,   1.48607e+00,   1.43966e+00,
     1.39022e+00,   1.33910e+00,   1.28764e+00,   1.23694e+00,
     1.18714e+00,   1.13810e+00,   1.08973e+00,   1.04190e+00,
     9.94544e-01,   9.47793e-01,   9.01824e-01,   8.56817e-01,
     8.12950e-01,   7.70395e-01,   7.29300e-01,   6.89808e-01,
     6.52061e-01,   6.16200e-01,   5.82329e-01,   5.50388e-01,
     5.20282e-01,   4.91912e-01,   4.65180e-01,   4.39994e-01,
     4.16281e-01,   3.93973e-01,   3.73002e-01,   3.53300e-01,
     3.34804e-01,   3.17467e-01,   3.01249e-01,   2.86107e-01,
     2.72000e-01,   2.58860e-01,   2.46517e-01,   2.34774e-01,
     2.23434e-01,   2.12300e-01,   2.01219e-01,   1.90208e-01,
     1.79327e-01,   1.68638e-01,   1.58200e-01,   1.48073e-01,
     1.38309e-01,   1.28958e-01,   1.20071e-01,   1.11700e-01,
     1.03885e-01,   9.66348e-02,   8.99464e-02,   8.38187e-02,
     7.82500e-02,   7.32267e-02,   6.86879e-02,   6.45607e-02,
     6.07723e-02,   5.72500e-02,   5.39295e-02,   5.07812e-02,
     4.77842e-02,   4.49175e-02,   4.21600e-02,   3.94954e-02,
     3.69251e-02,   3.44551e-02,   3.20914e-02,   2.98400e-02,
     2.77055e-02,   2.56868e-02,   2.37813e-02,   2.19865e-02,
     2.03000e-02,   1.87191e-02,   1.72414e-02,   1.58640e-02,
     1.45844e-02,   1.34000e-02,   1.23076e-02,   1.13021e-02,
     1.03777e-02,   9.52892e-03,   8.75000e-03,   8.03565e-03,
     7.38199e-03,   6.78551e-03,   6.24269e-03,   5.75000e-03,
     5.30381e-03,   4.89997e-03,   4.53423e-03,   4.20233e-03,
     3.90000e-03,   3.62353e-03,   3.37133e-03,   3.14237e-03,
     2.93560e-03,   2.75000e-03,   2.58449e-03,   2.43792e-03,
     2.30910e-03,   2.19686e-03,   2.10000e-03,   2.01731e-03,
     1.94740e-03,   1.88883e-03,   1.84018e-03,   1.80000e-03,
     1.76666e-03,   1.73769e-03,   1.71038e-03,   1.68204e-03,
     1.65000e-03,   1.61203e-03,   1.56786e-03,   1.51767e-03,
     1.46165e-03,   1.40000e-03,   1.33360e-03,   1.26608e-03,
     1.20175e-03,   1.14496e-03,   1.10000e-03,   1.06958e-03,
     1.04984e-03,   1.03532e-03,   1.02053e-03,   1.00000e-03,
     9.69699e-04,   9.31366e-04,   8.88183e-04,   8.43333e-04,
     8.00000e-04,   7.60427e-04,   7.23097e-04,   6.85554e-04,
     6.45340e-04,   6.00000e-04,   5.48113e-04,   4.92405e-04,
     4.36642e-04,   3.84585e-04,   3.40000e-04,   3.05682e-04,
     2.80561e-04,   2.62599e-04,   2.49758e-04,   2.40000e-04,
     2.31478e-04,   2.23109e-04,   2.14001e-04,   2.03262e-04,
     1.90000e-04,   1.73686e-04,   1.55242e-04,   1.35956e-04,
     1.17113e-04,   1.00000e-04,   8.56193e-05,   7.38417e-05,
     6.42545e-05,   5.64448e-05,   5.00000e-05,   4.45569e-05,
     3.99507e-05,   3.60660e-05,   3.27876e-05,   3.00000e-05,
     2.75929e-05,   2.54753e-05,   2.35613e-05,   2.17649e-05,
     2.00000e-05,   1.81915e-05,   1.63079e-05,   1.43286e-05,
     1.22328e-05,   1.00000e-05,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
     0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00
};

const double CIE_D65[NLAMBDA] = {
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    3.41000e-02,   3.60140e-01,   6.86180e-01,   1.01222e+00,
    1.33826e+00,   1.66430e+00,   1.99034e+00,   2.31638e+00,
    2.64242e+00,   2.96846e+00,   3.29450e+00,   4.98865e+00,
    6.68280e+00,   8.37695e+00,   1.00711e+01,   1.17652e+01,
    1.34594e+01,   1.51535e+01,   1.68477e+01,   1.85418e+01,
    2.02360e+01,   2.19177e+01,   2.35995e+01,   2.52812e+01,
    2.69630e+01,   2.86447e+01,   3.03265e+01,   3.20082e+01,
    3.36900e+01,   3.53717e+01,   3.70535e+01,   3.73430e+01,
    3.76326e+01,   3.79221e+01,   3.82116e+01,   3.85011e+01,
    3.87907e+01,   3.90802e+01,   3.93697e+01,   3.96593e+01,
    3.99488e+01,   4.04451e+01,   4.09414e+01,   4.14377e+01,
    4.19340e+01,   4.24302e+01,   4.29265e+01,   4.34228e+01,
    4.39191e+01,   4.44154e+01,   4.49117e+01,   4.50844e+01,
    4.52570e+01,   4.54297e+01,   4.56023e+01,   4.57750e+01,
    4.59477e+01,   4.61203e+01,   4.62930e+01,   4.64656e+01,
    4.66383e+01,   4.71834e+01,   4.77285e+01,   4.82735e+01,
    4.88186e+01,   4.93637e+01,   4.99088e+01,   5.04539e+01,
    5.09989e+01,   5.15440e+01,   5.20891e+01,   5.18777e+01,
    5.16664e+01,   5.14550e+01,   5.12437e+01,   5.10323e+01,
    5.08209e+01,   5.06096e+01,   5.03982e+01,   5.01869e+01,
    4.99755e+01,   5.04428e+01,   5.09100e+01,   5.13773e+01,
    5.18446e+01,   5.23118e+01,   5.27791e+01,   5.32464e+01,
    5.37137e+01,   5.41809e+01,   5.46482e+01,   5.74589e+01,
    6.02695e+01,   6.30802e+01,   6.58909e+01,   6.87015e+01,
    7.15122e+01,   7.43229e+01,   7.71336e+01,   7.99442e+01,
    8.27549e+01,   8.36280e+01,   8.45011e+01,   8.53742e+01,
    8.62473e+01,   8.71204e+01,   8.79936e+01,   8.88667e+01,
    8.97398e+01,   9.06129e+01,   9.14860e+01,   9.16806e+01,
    9.18752e+01,   9.20697e+01,   9.22643e+01,   9.24589e+01,
    9.26535e+01,   9.28481e+01,   9.30426e+01,   9.32372e+01,
    9.34318e+01,   9.27568e+01,   9.20819e+01,   9.14069e+01,
    9.07320e+01,   9.00570e+01,   8.93821e+01,   8.87071e+01,
    8.80322e+01,   8.73572e+01,   8.66823e+01,   8.85006e+01,
    9.03188e+01,   9.21371e+01,   9.39554e+01,   9.57736e+01,
    9.75919e+01,   9.94102e+01,   1.01228e+02,   1.03047e+02,
    1.04865e+02,   1.06079e+02,   1.07294e+02,   1.08508e+02,
    1.09722e+02,   1.10936e+02,   1.12151e+02,   1.13365e+02,
    1.14579e+02,   1.15794e+02,   1.17008e+02,   1.17088e+02,
    1.17169e+02,   1.17249e+02,   1.17330e+02,   1.17410e+02,
    1.17490e+02,   1.17571e+02,   1.17651e+02,   1.17732e+02,
    1.17812e+02,   1.17517e+02,   1.17222e+02,   1.16927e+02,
    1.16632e+02,   1.16336e+02,   1.16041e+02,   1.15746e+02,
    1.15451e+02,   1.15156e+02,   1.14861e+02,   1.14967e+02,
    1.15073e+02,   1.15180e+02,   1.15286e+02,   1.15392e+02,
    1.15498e+02,   1.15604e+02,   1.15711e+02,   1.15817e+02,
    1.15923e+02,   1.15212e+02,   1.14501e+02,   1.13789e+02,
    1.13078e+02,   1.12367e+02,   1.11656e+02,   1.10945e+02,
    1.10233e+02,   1.09522e+02,   1.08811e+02,   1.08865e+02,
    1.08920e+02,   1.08974e+02,   1.09028e+02,   1.09082e+02,
    1.09137e+02,   1.09191e+02,   1.09245e+02,   1.09300e+02,
    1.09354e+02,   1.09199e+02,   1.09044e+02,   1.08888e+02,
    1.08733e+02,   1.08578e+02,   1.08423e+02,   1.08268e+02,
    1.08112e+02,   1.07957e+02,   1.07802e+02,   1.07501e+02,
    1.07200e+02,   1.06898e+02,   1.06597e+02,   1.06296e+02,
    1.05995e+02,   1.05694e+02,   1.05392e+02,   1.05091e+02,
    1.04790e+02,   1.05080e+02,   1.05370e+02,   1.05660e+02,
    1.05950e+02,   1.06239e+02,   1.06529e+02,   1.06819e+02,
    1.07109e+02,   1.07399e+02,   1.07689e+02,   1.07361e+02,
    1.07032e+02,   1.06704e+02,   1.06375e+02,   1.06047e+02,
    1.05719e+02,   1.05390e+02,   1.05062e+02,   1.04733e+02,
    1.04405e+02,   1.04369e+02,   1.04333e+02,   1.04297e+02,
    1.04261e+02,   1.04225e+02,   1.04190e+02,   1.04154e+02,
    1.04118e+02,   1.04082e+02,   1.04046e+02,   1.03641e+02,
    1.03237e+02,   1.02832e+02,   1.02428e+02,   1.02023e+02,
    1.01618e+02,   1.01214e+02,   1.00809e+02,   1.00405e+02,
    1.00000e+02,   9.96334e+01,   9.92668e+01,   9.89003e+01,
    9.85337e+01,   9.81671e+01,   9.78005e+01,   9.74339e+01,
    9.70674e+01,   9.67008e+01,   9.63342e+01,   9.62796e+01,
    9.62250e+01,   9.61703e+01,   9.61157e+01,   9.60611e+01,
    9.60065e+01,   9.59519e+01,   9.58972e+01,   9.58426e+01,
    9.57880e+01,   9.50778e+01,   9.43675e+01,   9.36573e+01,
    9.29470e+01,   9.22368e+01,   9.15266e+01,   9.08163e+01,
    9.01061e+01,   8.93958e+01,   8.86856e+01,   8.88177e+01,
    8.89497e+01,   8.90818e+01,   8.92138e+01,   8.93459e+01,
    8.94780e+01,   8.96100e+01,   8.97421e+01,   8.98741e+01,
    9.00062e+01,   8.99655e+01,   8.99248e+01,   8.98841e+01,
    8.98434e+01,   8.98026e+01,   8.97619e+01,   8.97212e+01,
    8.96805e+01,   8.96398e+01,   8.95991e+01,   8.94091e+01,
    8.92190e+01,   8.90290e+01,   8.88389e+01,   8.86489e+01,
    8.84589e+01,   8.82688e+01,   8.80788e+01,   8.78887e+01,
    8.76987e+01,   8.72577e+01,   8.68167e+01,   8.63757e+01,
    8.59347e+01,   8.54936e+01,   8.50526e+01,   8.46116e+01,
    8.41706e+01,   8.37296e+01,   8.32886e+01,   8.33297e+01,
    8.33707e+01,   8.34118e+01,   8.34528e+01,   8.34939e+01,
    8.35350e+01,   8.35760e+01,   8.36171e+01,   8.36581e+01,
    8.36992e+01,   8.33320e+01,   8.29647e+01,   8.25975e+01,
    8.22302e+01,   8.18630e+01,   8.14958e+01,   8.11285e+01,
    8.07613e+01,   8.03940e+01,   8.00268e+01,   8.00456e+01,
    8.00644e+01,   8.00831e+01,   8.01019e+01,   8.01207e+01,
    8.01395e+01,   8.01583e+01,   8.01770e+01,   8.01958e+01,
    8.02146e+01,   8.04209e+01,   8.06272e+01,   8.08336e+01,
    8.10399e+01,   8.12462e+01,   8.14525e+01,   8.16588e+01,
    8.18652e+01,   8.20715e+01,   8.22778e+01,   8.18784e+01,
    8.14791e+01,   8.10797e+01,   8.06804e+01,   8.02810e+01,
    7.98816e+01,   7.94823e+01,   7.90829e+01,   7.86836e+01,
    7.82842e+01,   7.74279e+01,   7.65716e+01,   7.57153e+01,
    7.48590e+01,   7.40027e+01,   7.31465e+01,   7.22902e+01,
    7.14339e+01,   7.05776e+01,   6.97213e+01,   6.99101e+01,
    7.00989e+01,   7.02876e+01,   7.04764e+01,   7.06652e+01,
    7.08540e+01,   7.10428e+01,   7.12315e+01,   7.14203e+01,
    7.16091e+01,   7.18831e+01,   7.21571e+01,   7.24311e+01,
    7.27051e+01,   7.29790e+01,   7.32530e+01,   7.35270e+01,
    7.38010e+01,   7.40750e+01,   7.43490e+01,   7.30745e+01,
    7.18000e+01,   7.05255e+01,   6.92510e+01,   6.79765e+01,
    6.67020e+01,   6.54275e+01,   6.41530e+01,   6.28785e+01,
    6.16040e+01,   6.24322e+01,   6.32603e+01,   6.40885e+01,
    6.49166e+01,   6.57448e+01,   6.65730e+01,   6.74011e+01,
    6.82293e+01,   6.90574e+01,   6.98856e+01,   7.04057e+01,
    7.09259e+01,   7.14460e+01,   7.19662e+01,   7.24863e+01,
    7.30064e+01,   7.35266e+01,   7.40467e+01,   7.45669e+01,
    7.50870e+01,   7.39376e+01,   7.27881e+01,   7.16387e+01,
    7.04893e+01,   6.93398e+01,   6.81904e+01,   6.70410e+01,
    6.58916e+01,   6.47421e+01,   6.35927e+01,   6.18752e+01,
    6.01578e+01,   5.84403e+01,   5.67229e+01,   5.50054e+01,
    5.32880e+01,   5.15705e+01,   4.98531e+01,   4.81356e+01,
    4.64182e+01,   4.84569e+01,   5.04956e+01,   5.25344e+01,
    5.45731e+01,   5.66118e+01,   5.86505e+01,   6.06892e+01,
    6.27280e+01,   6.47667e+01,   6.68054e+01,   6.64631e+01,
    6.61209e+01,   6.57786e+01,   6.54364e+01,   6.50941e+01,
    6.47518e+01,   6.44096e+01,   6.40673e+01,   6.37251e+01,
    6.33828e+01,   6.34749e+01,   6.35670e+01,   6.36592e+01,
    6.37513e+01,   6.38434e+01,   6.39355e+01,   6.40276e+01,
    6.41198e+01,   6.42119e+01,   6.43040e+01,   6.38188e+01,
    6.33336e+01,   6.28484e+01,   6.23632e+01,   6.18779e+01,
    6.13927e+01,   6.09075e+01,   6.04223e+01,   5.99371e+01,
    5.94519e+01,   5.87026e+01,   5.79533e+01,   5.72040e+01,
    5.64547e+01,   5.57054e+01,   5.49562e+01,   5.42069e+01,
    5.34576e+01,   5.27083e+01,   5.19590e+01,   5.25072e+01,
    5.30553e+01,   5.36035e+01,   5.41516e+01,   5.46998e+01,
    5.52480e+01,   5.57961e+01,   5.63443e+01,   5.68924e+01,
    5.74406e+01,   5.77278e+01,   5.80150e+01,   5.83022e+01,
    5.85894e+01,   5.88765e+01,   5.91637e+01,   5.94509e+01,
    5.97381e+01,   6.00253e+01,   6.03125e+01,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00,
    0.00000e+00,   0.00000e+00,   0.00000e+00,   0.00000e+00
};
